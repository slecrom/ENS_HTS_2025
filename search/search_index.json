{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Introduction This GitHub directory is used for the course \"Functional genomic data analysis: transcriptomics 2025\" You can directly access to the content of the practical work for: Dataset Preprocessing Data analysis A bonus section is available to visualize RNAseq alignements using a genome browser . During this course, you will work remotely on the IFB-core Cluster managed by the French Institute of Bioinformatics (IFB) the national bioinformatics infrastructure that provides support, deploys services, organizes training and carries out innovative developments for the life sciences communities. You can read the following tutorials in order to access IFB-core Cluster ressources. How to work with the IFB cluster Useful tips and commands If you want to leverage the power of artificial intelligence for the practicals, look at this page. AI for code","title":"Introduction"},{"location":"#introduction","text":"This GitHub directory is used for the course \"Functional genomic data analysis: transcriptomics 2025\" You can directly access to the content of the practical work for: Dataset Preprocessing Data analysis A bonus section is available to visualize RNAseq alignements using a genome browser . During this course, you will work remotely on the IFB-core Cluster managed by the French Institute of Bioinformatics (IFB) the national bioinformatics infrastructure that provides support, deploys services, organizes training and carries out innovative developments for the life sciences communities. You can read the following tutorials in order to access IFB-core Cluster ressources. How to work with the IFB cluster Useful tips and commands If you want to leverage the power of artificial intelligence for the practicals, look at this page. AI for code","title":"Introduction"},{"location":"AIforCode/","text":"AI for code As Master's students, enhancing your coding skills is crucial, and leveraging generative AI tools can significantly accelerate coding efficiency and quality. These tools can help you write, debug, and optimize code faster, allowing you to focus on solving complex biological problems rather than getting stuck on syntax or logic issues. Embrace these technologies to stay ahead in the rapidly evolving field of bioinformatics! The following tools are excellent resources: GitHub Copilot Claude code OpenAI's GPT models Google's Gemini Codestral from Mistral Le Chat Many of these tools offer free versions for students, making them accessible for your academic projects. Additional tips Start with simple tasks and gradually increase the complexity. While these tools are powerful, they are not a replacement for understanding the underlying concepts. You should always critically evaluate the output of these tools and not blindly trust it.","title":"AI for code"},{"location":"AIforCode/#ai-for-code","text":"As Master's students, enhancing your coding skills is crucial, and leveraging generative AI tools can significantly accelerate coding efficiency and quality. These tools can help you write, debug, and optimize code faster, allowing you to focus on solving complex biological problems rather than getting stuck on syntax or logic issues. Embrace these technologies to stay ahead in the rapidly evolving field of bioinformatics! The following tools are excellent resources: GitHub Copilot Claude code OpenAI's GPT models Google's Gemini Codestral from Mistral Le Chat Many of these tools offer free versions for students, making them accessible for your academic projects. Additional tips Start with simple tasks and gradually increase the complexity. While these tools are powerful, they are not a replacement for understanding the underlying concepts. You should always critically evaluate the output of these tools and not blindly trust it.","title":"AI for code"},{"location":"Dataset/","text":"Dataset Data used in this practical were collected from the following publication: Guida, A., Lindst\u00e4dt, C., Maguire, S. L., Ding, C., Higgins, D. G., Corton, N. J., Berriman, M., et al. (2011). Using RNA-seq to determine the transcriptional landscape and the hypoxic response of the pathogenic yeast Candida parapsilosis . Guida et al . BMC Genomics 2011 The authors used high throughput technologies ( microarrays and high throughput sequencing ) to determine the transcriptional profile of the pathogenic yeast Candida parapsilosis growing in several conditions including media, temperature and oxygen concentrations. You will use the datasets related to the study of the hypoxic (low oxygen) response in C. parapsilosis . The raw sequencing files located into the projet data folder of the IFB-core Cluster : /shared/projects/2528_ens_master2lf_fgat/rnaseq/ where retrieved from the EBI European Electronic Archive using the study accession number PRJNA154483 .","title":"1. Dataset"},{"location":"Dataset/#dataset","text":"Data used in this practical were collected from the following publication: Guida, A., Lindst\u00e4dt, C., Maguire, S. L., Ding, C., Higgins, D. G., Corton, N. J., Berriman, M., et al. (2011). Using RNA-seq to determine the transcriptional landscape and the hypoxic response of the pathogenic yeast Candida parapsilosis . Guida et al . BMC Genomics 2011 The authors used high throughput technologies ( microarrays and high throughput sequencing ) to determine the transcriptional profile of the pathogenic yeast Candida parapsilosis growing in several conditions including media, temperature and oxygen concentrations. You will use the datasets related to the study of the hypoxic (low oxygen) response in C. parapsilosis . The raw sequencing files located into the projet data folder of the IFB-core Cluster : /shared/projects/2528_ens_master2lf_fgat/rnaseq/ where retrieved from the EBI European Electronic Archive using the study accession number PRJNA154483 .","title":"Dataset"},{"location":"IFB_OpenOnDemand/","text":"How to work with the IFB cluster You're going to use Open OnDemand , a browser-based portal to all resources within the IFB cluster. Sign in on IFB cluster Open OnDemand In a web browser, connect to https://ondemand.cluster.france-bioinformatique.fr// and log in using your IFB username and password. Clic on the \"Grant Access\" button. Internal Server Error If you get the error message \"Internal Server Error\" after grant access, this is a problem with the browser's cookies. Switching to a private browser window solves the problem. Bookmark this URL in your browser for easy retrieval. Using a JupyterLab session to access Unix terminal Clic on the \"JupyterLab\" tile Select your server options On the following screen you can select the option used by our JupyterHub server during the practical. Two nodes have been booked for our training session on IFB server. To build your server on these nodes select the following options: Reservation: 2528_fgat Account: 2528_ens_master2lf_fgat Partition: fast CPU: 2 Memory: 2G GPUs: No GPU Number of hours: 3 Clic on \"Launch\" and wait for the JupyterLab session to be created. Once running, clic on \"Connect to Jupyter\" to access the server. Start a terminal session Once your server has been launched, you will be taken to the application launcher page. You can click on the \"Terminal\" tile in order to open a terminal window. Using an Rstudio environment Clic on the \"RStudio Server\" tile Select your server options On the following screen you can select the option used by our RStudio server during the practical. Two nodes have been booked for our training session on IFB server. To build your server on these nodes select the following options: Reservation: 2528_fgat Account: 2528_ens_master2lf_fgat Partition: fast CPU: 2 Memory: 3G GPUs: No GPU Number of hours: 3 Clic on \"Launch\" and wait for the RStudio session to be created. Once running, clic on \"Connect to RStudio Server\" to access the server. You can get more information using the IFB-core Cluster documentation and the dedicated Open On Demand pages .","title":"How to work with the IFB server"},{"location":"IFB_OpenOnDemand/#how-to-work-with-the-ifb-cluster","text":"You're going to use Open OnDemand , a browser-based portal to all resources within the IFB cluster.","title":"How to work with the IFB cluster"},{"location":"IFB_OpenOnDemand/#sign-in-on-ifb-cluster-open-ondemand","text":"In a web browser, connect to https://ondemand.cluster.france-bioinformatique.fr// and log in using your IFB username and password. Clic on the \"Grant Access\" button. Internal Server Error If you get the error message \"Internal Server Error\" after grant access, this is a problem with the browser's cookies. Switching to a private browser window solves the problem. Bookmark this URL in your browser for easy retrieval.","title":"Sign in on IFB cluster Open OnDemand"},{"location":"IFB_OpenOnDemand/#using-a-jupyterlab-session-to-access-unix-terminal","text":"Clic on the \"JupyterLab\" tile","title":"Using a JupyterLab session to access Unix terminal"},{"location":"IFB_OpenOnDemand/#select-your-server-options","text":"On the following screen you can select the option used by our JupyterHub server during the practical. Two nodes have been booked for our training session on IFB server. To build your server on these nodes select the following options: Reservation: 2528_fgat Account: 2528_ens_master2lf_fgat Partition: fast CPU: 2 Memory: 2G GPUs: No GPU Number of hours: 3 Clic on \"Launch\" and wait for the JupyterLab session to be created. Once running, clic on \"Connect to Jupyter\" to access the server.","title":"Select your server options"},{"location":"IFB_OpenOnDemand/#start-a-terminal-session","text":"Once your server has been launched, you will be taken to the application launcher page. You can click on the \"Terminal\" tile in order to open a terminal window.","title":"Start a terminal session"},{"location":"IFB_OpenOnDemand/#using-an-rstudio-environment","text":"Clic on the \"RStudio Server\" tile","title":"Using an Rstudio environment"},{"location":"IFB_OpenOnDemand/#select-your-server-options_1","text":"On the following screen you can select the option used by our RStudio server during the practical. Two nodes have been booked for our training session on IFB server. To build your server on these nodes select the following options: Reservation: 2528_fgat Account: 2528_ens_master2lf_fgat Partition: fast CPU: 2 Memory: 3G GPUs: No GPU Number of hours: 3 Clic on \"Launch\" and wait for the RStudio session to be created. Once running, clic on \"Connect to RStudio Server\" to access the server. You can get more information using the IFB-core Cluster documentation and the dedicated Open On Demand pages .","title":"Select your server options"},{"location":"Usefultips/","text":"Useful tips and commands Here are some useful command lines you may need to work on ENS local computer and the IFB-core Cluster during the practical. You can find more detailed information on IFB-core Cluster Documentation . How to download/upload your data from the cluster To download files from the cluster to your current directory scp '<your login>@core.cluster.france-bioinformatique.fr:/<absolute path to your file>' . To download a folder from the cluster to your current directory scp -r '<your login>@core.cluster.france-bioinformatique.fr:/<absolute path to your folder>' . To upload a file to the cluster scp '<path to your local file>' '<your login>@core.cluster.france-bioinformatique.fr:/<absolute path to the target folder>' IFB-core cluster connexion Beware of passwords that contains a '^' sign, you will need to copy/paste the password from a text file in order to work on ENS computers. If you get an error message because your login is too long 'too long for Unix domain socket' you could replace the server name by its IP address: 192.54.201.181 ssh <your login>@192.54.201.181","title":"Useful tips and commands"},{"location":"Usefultips/#useful-tips-and-commands","text":"Here are some useful command lines you may need to work on ENS local computer and the IFB-core Cluster during the practical. You can find more detailed information on IFB-core Cluster Documentation .","title":"Useful tips and commands"},{"location":"Usefultips/#how-to-downloadupload-your-data-from-the-cluster","text":"To download files from the cluster to your current directory scp '<your login>@core.cluster.france-bioinformatique.fr:/<absolute path to your file>' . To download a folder from the cluster to your current directory scp -r '<your login>@core.cluster.france-bioinformatique.fr:/<absolute path to your folder>' . To upload a file to the cluster scp '<path to your local file>' '<your login>@core.cluster.france-bioinformatique.fr:/<absolute path to the target folder>'","title":"How to download/upload your data from the cluster"},{"location":"Usefultips/#ifb-core-cluster-connexion","text":"Beware of passwords that contains a '^' sign, you will need to copy/paste the password from a text file in order to work on ENS computers. If you get an error message because your login is too long 'too long for Unix domain socket' you could replace the server name by its IP address: 192.54.201.181 ssh <your login>@192.54.201.181","title":"IFB-core cluster connexion"},{"location":"prerequisites/","text":"Prerequisites Microarrays Prerequisite 1 - Microarrays Microarray technology (4'22) High throughput sequencing Prerequiste 2 - High throughput sequencing The Sanger method of DNA sequencing (3') Illumina sequencing technology (5') Oxford Nanopore Technologies sequencing (2') Reminder for R R programming language introduction Rstudio education ressources for beginners Introduction to R syntax Sandbox.bio is a free platform for bioinformatics command-line tutorials that could run in the browser. You can learn basics of the Unix command line interface, Unix file system and combining bash commands. You can access it using this link: Interactive bioinformatics tutorials","title":"Prerequisites"},{"location":"prerequisites/#prerequisites","text":"","title":"Prerequisites"},{"location":"prerequisites/#microarrays","text":"Prerequisite 1 - Microarrays Microarray technology (4'22)","title":"Microarrays"},{"location":"prerequisites/#high-throughput-sequencing","text":"Prerequiste 2 - High throughput sequencing The Sanger method of DNA sequencing (3') Illumina sequencing technology (5') Oxford Nanopore Technologies sequencing (2')","title":"High throughput sequencing"},{"location":"prerequisites/#reminder-for-r","text":"R programming language introduction Rstudio education ressources for beginners Introduction to R syntax Sandbox.bio is a free platform for bioinformatics command-line tutorials that could run in the browser. You can learn basics of the Unix command line interface, Unix file system and combining bash commands. You can access it using this link: Interactive bioinformatics tutorials","title":"Reminder for R"},{"location":"DataAnalysis/DataAnalysis/","text":"Data analysis Introduction Search for differentially expressed genes Functional analyses of differentially expressed genes Introduction Objective of this practical session During this practical session, you will learn: To perform statistical analysis of the gene expression matrix in order to identify differentialy expressed genes between two conditions. To find biological relevant target genes Search for differentially expressed genes In their article (Guida et al., 2011), the authors repeated the experiment 6 times for normoxic condition (with O2) and 4 times for hypoxic conditions (without O2). What you have to do Search for differentially expressed genes using limma and DESeq2 R packages for microarrays and RNAseq experiments. How many genes are selected with different adjusted p-value thresholds (5%, 1%, etc.)? Set up your working environment Connect to Rstudio server of the IFB. Look at the tutorial on how to connect to IFB-core Rstudio server to see how to proceed. Save the working notebook in your personal environment In \" File > Open File... \" enter the path /shared/projects/2528_ens_master2lf_fgat/data/tutorials/data_analysis.Rmd to open the notebook containing all the code needed for the practical. 2. Save it into your personal folder on your IFB account using \" File > Save As \" Follow the instruction of the notebook to conduct the analysis You can also visualize the final report version . You can find help on how to use R markdown on the R markdown project webpage . Functional analyses of differentially expressed genes Several tools are available online to evaluate the biological relevance of the gene sets you select after the differential analysis. For example you can you use the GoTermFinder tool dedicated to Candida yeast species to retrieve functional annotation. Be careful to choose the genome of Candida parapsilosis in the species selection dialog box. You can also obtain information on a specific gene using the Candida Genome Database . What you have to do What are the functions of the genes in your lists (identified at the previous step). Are they relevant with the studied biological system described by Guida et al. in their publication? Compare your results with those presented in the original publication To go further with functional analyses, you can read the Nine quick tips for pathway enrichment analysis article","title":"3. Data analysis"},{"location":"DataAnalysis/DataAnalysis/#data-analysis","text":"Introduction Search for differentially expressed genes Functional analyses of differentially expressed genes","title":"Data analysis"},{"location":"DataAnalysis/DataAnalysis/#introduction","text":"Objective of this practical session During this practical session, you will learn: To perform statistical analysis of the gene expression matrix in order to identify differentialy expressed genes between two conditions. To find biological relevant target genes","title":"Introduction"},{"location":"DataAnalysis/DataAnalysis/#search-for-differentially-expressed-genes","text":"In their article (Guida et al., 2011), the authors repeated the experiment 6 times for normoxic condition (with O2) and 4 times for hypoxic conditions (without O2). What you have to do Search for differentially expressed genes using limma and DESeq2 R packages for microarrays and RNAseq experiments. How many genes are selected with different adjusted p-value thresholds (5%, 1%, etc.)?","title":"Search for differentially expressed genes"},{"location":"DataAnalysis/DataAnalysis/#set-up-your-working-environment","text":"Connect to Rstudio server of the IFB. Look at the tutorial on how to connect to IFB-core Rstudio server to see how to proceed.","title":"Set up your working environment"},{"location":"DataAnalysis/DataAnalysis/#save-the-working-notebook-in-your-personal-environment","text":"In \" File > Open File... \" enter the path /shared/projects/2528_ens_master2lf_fgat/data/tutorials/data_analysis.Rmd to open the notebook containing all the code needed for the practical. 2. Save it into your personal folder on your IFB account using \" File > Save As \"","title":"Save the working notebook in your personal environment"},{"location":"DataAnalysis/DataAnalysis/#follow-the-instruction-of-the-notebook-to-conduct-the-analysis","text":"You can also visualize the final report version . You can find help on how to use R markdown on the R markdown project webpage .","title":"Follow the instruction of the notebook to conduct the analysis"},{"location":"DataAnalysis/DataAnalysis/#functional-analyses-of-differentially-expressed-genes","text":"Several tools are available online to evaluate the biological relevance of the gene sets you select after the differential analysis. For example you can you use the GoTermFinder tool dedicated to Candida yeast species to retrieve functional annotation. Be careful to choose the genome of Candida parapsilosis in the species selection dialog box. You can also obtain information on a specific gene using the Candida Genome Database . What you have to do What are the functions of the genes in your lists (identified at the previous step). Are they relevant with the studied biological system described by Guida et al. in their publication? Compare your results with those presented in the original publication To go further with functional analyses, you can read the Nine quick tips for pathway enrichment analysis article","title":"Functional analyses of differentially expressed genes"},{"location":"DataAnalysis/IGV/","text":"Alignments visualization using a genome browser IGV The Integrative Genomics Viewer (IGV) is a high-performance visualization tool for interactive exploration of large genomic datasets. It supports a wide variety of data types, including array-based, high throughput sequence data and genomic annotations. In this practical, we will use IGV to visualize mapping results. Download the necessary files on your computer To download files from the cluster to your current directory (on your own computer), open a new terminal and run the following command . Alternatively you can use the file browsing system of Open On Demand web portal. # First bam and bai alignement files scp '<your login>@core.cluster.france-bioinformatique.fr:~/RNAseq/2-Mapping/*.bam*' . # Next the reference genome sequence and gene annotation files scp '<your login>@core.cluster.france-bioinformatique.fr:/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_CGD.fasta' . scp '<your login>@core.cluster.france-bioinformatique.fr:/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_ORFs.gff' . Visualize mapping results with IGV On linux type igv in a terminal window to launch the program (You can also download IGV and follow the instalation instructions according to your OS). Once the IGV program is launched, it is necessary to load the reference genome \u201cGenomes/Load Genome from File...\u201d (see below). Select the FASTA file with the genomic sequence of C. parapsilosis \u201cC_parapsilosis_CGD.fasta\u201d downloaded from IFB server. Attention In order to IGV to create an index of your genome, you need to copy the reference genome FASTA file in a directory where you have write permission. Next, load the C. parapsilosis annotation file \"C_parapsilosis_ORFs.gff\" using the \u201cFile/Load from File...\u201d menu. Go to \"File/Save session\u2026\" menu in order to backup all your parameters and visualisation options. C. parapsilosis genome and annotation are now loaded into IGV and can be selected from the top/left menu (see 1 below). The genomic sequence can be therefore explored, choosing for instance, a particular chromosome (see 2 below) or a genomic region (see 3). Note that gene annotations (ORF positions) are shown at the bottom of the window (see 4, blue lines) and you can obtain a more detailed view of the sequence using the cursor located on the top/right of the window, see 5). Mapping results (\u201c.sorted.bam\u201d files) can now be imported (\u201cFile / Load from File\u201d). Zoom in genomic regions in order to visualize read alignements. You can color reads according to several properties such as read strand by right click on the desire track. What you have to do Did the authors of the article use stranded-specific protocols? Do you validate the differentially expressed genes found at the previous steps?","title":"Bonus. Alignments visualization"},{"location":"DataAnalysis/IGV/#alignments-visualization-using-a-genome-browser","text":"IGV The Integrative Genomics Viewer (IGV) is a high-performance visualization tool for interactive exploration of large genomic datasets. It supports a wide variety of data types, including array-based, high throughput sequence data and genomic annotations. In this practical, we will use IGV to visualize mapping results.","title":"Alignments visualization using a genome browser"},{"location":"DataAnalysis/IGV/#download-the-necessary-files-on-your-computer","text":"To download files from the cluster to your current directory (on your own computer), open a new terminal and run the following command . Alternatively you can use the file browsing system of Open On Demand web portal. # First bam and bai alignement files scp '<your login>@core.cluster.france-bioinformatique.fr:~/RNAseq/2-Mapping/*.bam*' . # Next the reference genome sequence and gene annotation files scp '<your login>@core.cluster.france-bioinformatique.fr:/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_CGD.fasta' . scp '<your login>@core.cluster.france-bioinformatique.fr:/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_ORFs.gff' .","title":"Download the necessary files on your computer"},{"location":"DataAnalysis/IGV/#visualize-mapping-results-with-igv","text":"On linux type igv in a terminal window to launch the program (You can also download IGV and follow the instalation instructions according to your OS). Once the IGV program is launched, it is necessary to load the reference genome \u201cGenomes/Load Genome from File...\u201d (see below). Select the FASTA file with the genomic sequence of C. parapsilosis \u201cC_parapsilosis_CGD.fasta\u201d downloaded from IFB server. Attention In order to IGV to create an index of your genome, you need to copy the reference genome FASTA file in a directory where you have write permission. Next, load the C. parapsilosis annotation file \"C_parapsilosis_ORFs.gff\" using the \u201cFile/Load from File...\u201d menu. Go to \"File/Save session\u2026\" menu in order to backup all your parameters and visualisation options. C. parapsilosis genome and annotation are now loaded into IGV and can be selected from the top/left menu (see 1 below). The genomic sequence can be therefore explored, choosing for instance, a particular chromosome (see 2 below) or a genomic region (see 3). Note that gene annotations (ORF positions) are shown at the bottom of the window (see 4, blue lines) and you can obtain a more detailed view of the sequence using the cursor located on the top/right of the window, see 5). Mapping results (\u201c.sorted.bam\u201d files) can now be imported (\u201cFile / Load from File\u201d). Zoom in genomic regions in order to visualize read alignements. You can color reads according to several properties such as read strand by right click on the desire track. What you have to do Did the authors of the article use stranded-specific protocols? Do you validate the differentially expressed genes found at the previous steps?","title":"Visualize mapping results with IGV"},{"location":"Preprocessing/Preprocessing/","text":"Preprocessing of high throughput data Introduction Microarrays data preprocessing RNAseq data preprocessing Introduction Objective of this practical session During this practical session, you will learn: To perform experimental biases estimation and correction of microarrays GPR files. You will first perform quality control of the imaged glass slides before choosing the best normalisation method to apply. To conduct an analysis of RNA-seq raw fastq files. You will first perform quality control of the sequencer file outputs before proceding to the mapping of the reads onto the reference genome and normalise your data. Microarrays data preprocessing Set up your working environment Connect to Rstudio server of the IFB. Look at the tutorial on how to connect to IFB-core Rstudio server to see how to proceed. Save the working notebook in your personal environment In \" File > Open File... \" enter the path /shared/projects/2528_ens_master2lf_fgat/data/tutorials/preprocessing_microarrays.Rmd to open the notebook containing all the code needed for the practical. 2. Save it into your personal folder on your IFB account using \" File > Save As \". You can access the path of your home folder using \"~\". Follow the instruction of the notebook to conduct the analysis You can also visualize the final report version . You can find help on how to use R markdown on the R markdown project webpage . RNAseq data preprocessing Set up your working environment Connect to the IFB-core JupyterLab server. Look at the tutorial to see how to proceed. You can also look at the useful commands to work on the IFB-core Cluster page. Go to your home directory cd Create a directory that will contain all results of the upcoming analyses mkdir RNAseq Go to the newly created directory cd RNAseq Check your are in the right directory using the pwd command pwd /shared/home/<your login>/RNAseq Sequence quality controls Fastq files Fastq files are raw results from RNA-seq experiments. These files comprise all the sequences (or reads) obtained from the sequencer device (Illumina technology in this practical), together with base quality scores (PHRED scores). Two different files will be analyzed during this practical from Guida et al. publication: O2rep2_SRR352263.fastq refereed to a transcriptome analysis of yeasts C. parapsilosis under normoxic condition ( ENA access number: SRR352263 ) noO2rep3_SRR352271.fastq refereed to a transcriptome analysis of yeasts C. parapsilosis under hypoxic condition ( ENA access number: SRR352271 ) In a first step, controls will be performed on each FASTQ files in order to evaluate the overall quality of the sequences and identify potential problems that could impact the following analyses. During this practical we will use the FastQC software solution. FastQC FastQC is a quality control application for high throughput sequence data. It provides an interactive application to review the results of several different quality control checks, and create an HTML based report . The main functions of FastQC are: Import of data from BAM, SAM or FastQ files (any variant) Providing a quick overview to tell you in which areas there may be problems Summary graphs and tables to quickly assess your data Export of results to an HTML based report Offline operation mode to allow automated generation of reports without running the interactive application What you have to do Use FASTQC to evaluate the quality of sequences in each FASTQ files. Using information from the Fastqc help page as well as exemples of good or bad illumina data as references. Compare results between the two FASTQ files. Is there any concern related to the following analyses? Create a new directory to store the output of fastqc mkdir 1-QC # Using the `tree` command, your directory should look like this: tree \u2502 \u2514\u2500\u2500\u25001-QC Go to this directory cd 1-QC Make fastqc available in your environment module load fastqc/0.12.1 Run fastqc on each experiment files # Absolute path to the file: # /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/O2rep2_SRR352263.fastq # # -o option creates all output files in the specified output directory, # '.' means current directory # O2 condition fastqc /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/O2rep2_SRR352263.fastq -o . # noO2 condition fastqc /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/noO2rep3_SRR352271.fastq -o . At this point you should see the new files in your directory using the tree command tree \u2502 \u2514\u2500\u2500\u25001-QC \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.html \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.zip \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.html \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.zip Open the HTML file reports on your local machine Select \"Home directory\", from the \"Files\" menu of your IFB cluster Open On Demand dashboard. Navigate through the \"1-QC\" directory and open the .html reports using your internet browser. Mapping of reads on the reference genome Once data quality is verified, reads will be mapped onto the reference genome of yeast C. parapsilosis . The genome sequence of C. parapsilosis and its annotations (locations of ORFs) were retrieved from the Candidat genome database (CGD) . Bowtie Different aligner and algorithms for RNA-seq analysis exist. We will use Bowtie 1.3 an ultrafast (memory-efficient) short read aligner. As an input, Bowtie uses a Fastq file (with reads to be aligned) and \u201cpre-built indexes\u201d of the reference genome. These indexes are named \u201cC_parapsilosis.1.ebwt\u201d , \u201cC_parapsilosis.2.ebwt\u201d , etc. They will allow boosting the alignment process. As an output, Bowtie provides a SAM file . SAM (Sequence Alignment/Map) is a generic format for storing large nucleotide sequence alignments. What you have to do Run sequence alignments with Bowtie using the two Fastq files While Bowtie is running, take a look at Bowtie documentation that describes the options (particularly the -m ) Look at the alignment statistic outputs (file .out) What is the proportion of reads aligned on the reference genome? Is there any concern to take into account for the following analyses? Create a new directory to store the output of bowtie #Go back to the parental directory \"RNAseq\" cd ../ #Create a new directory to store results of the alignment mkdir 2-Mapping Your directory should now look like this : tree \u2502 \u2514\u2500\u2500\u25001-QC \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.html \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.zip \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.html \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.zip \u2514\u2500\u2500\u2500 2-Mapping Go to the newly created directory cd 2-Mapping Load Bowtie into your environment module load bowtie/1.3.1 Map the reads to the reference genome ## We will use the following options: # \"-S\" will output the result in SAM format # # \"/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/bowtie_indexes/C_parapsilosis\" # specify the location and the \"prefix (C_parapsilosis)\"\" of the bowtie's # index files # # \"/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/Fastqc/O2rep2_SRR352263.fastq.gz\" # location of the input fastq # # \"2>\" will save in a file some statistics about the aligment (number of # reads mapped, etc...) # # \"> redirects the mapping output into a .sam file # Map the aerobic condition reads bowtie -S /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/bowtie_indexes/C_parapsilosis /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/O2rep2_SRR352263.fastq 2> O2rep2_SRR352263_bowtie_mapping.out > O2rep2_SRR352263_bowtie_mapping.sam # Map the hypoxic condition reads bowtie -S /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/bowtie_indexes/C_parapsilosis /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/noO2rep3_SRR352271.fastq 2> noO2rep3_SRR352271_bowtie_mapping.out > noO2rep3_SRR352271_bowtie_mapping.sam Your directory should now look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u2514\u2500\u2500 2-Mapping \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam Take a look at the outputs of the mapping step less O2rep2_SRR352263_bowtie_mapping.out # reads processed: 10213665 # reads with at least one reported alignment: 9160950 (89.69%) # reads that failed to align: 1052715 (10.31%) # reported 9160950 alignments less noO2rep3_SRR352271_bowtie_mapping.out # reads processed: 10136009 # reads with at least one reported alignment: 9252408 (91.28%) # reads that failed to align: 883601 (8.72%) # reported 9252408 alignment Post-processing of alignment files In order to facilitate alignement manipulation, SAM files have to be converted into BAM files (a binary version) and alignements \u201csorted\u201d according to their localisation on the genome and files indexed in order to speed up their access. We will use the Samtools suite to perform these steps. What you have to do Convert SAM files into BAM files Sort and index BAM files Sort and convert .sam into .bam files ## \"samtools sort\" sort alignments by genomic coordinates # \"|\" \"pipe\" the output of samtools sort to the next program # ## \"samtools view\" will convert sam into bam # option \"-b\" specify the output to be in BAM format # \">\"\" write the output in the bam file module load samtools/1.21 # Sort and convert O2 condition samtools sort O2rep2_SRR352263_bowtie_mapping.sam | samtools view -b > O2rep2_SRR352263_bowtie_sorted.bam # Sort and convert noO2 condition samtools sort noO2rep3_SRR352271_bowtie_mapping.sam | samtools view -b > noO2rep3_SRR352271_bowtie_sorted.bam Error message using samtools If you get an error message during samtools execution, check that you booked 2G of RAM for your JupyterLab environment. Create indexes for the bam files The index of a bam file is named .bam.bai # Index the O2 condition samtools index O2rep2_SRR352263_bowtie_sorted.bam # Index the noO2 condition samtools index noO2rep3_SRR352271_bowtie_sorted.bam Your directory should now look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u2514\u2500\u2500 2-Mapping \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam.bai \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam.bai Gene counts estimation To identify genes whose expression is different between hypoxic and normoxic conditions, we will count and compare the number of reads mapped to each ORF . A program available in the Bedtools suite will be used for this purpose. What you have to do Calculate for each ORF the number of reads that were aligned (normoxic and hypoxic conditions). Create a new directory to store the ORF count matrix # Go to the parental directory \"RNAseq\" cd ../ # Create a new directory to store results of the alignment mkdir 3-Counts Your directory should now look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u251c\u2500\u2500 2-Mapping \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam.bai \u2502 \u251c\u2500\u2500 core \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam.bai \u2514\u2500\u2500 3-Counts Go to the newly created directory cd 3-Counts Calculate for each ORF the number of reads that were aligned to it module load bedtools/2.31.1 # Counting matrix for the O2 condition bedtools multicov -bams ../2-Mapping/O2rep2_SRR352263_bowtie_sorted.bam -bed /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_ORFs.gff > O2rep2_SRR352263_gene_counts.gff # Output formating sed 's/^.*ID=//' O2rep2_SRR352263_gene_counts.gff > O2rep2_SRR352263_gene_counts.tab # Counting matrix for the noO2 condition bedtools multicov -bams ../2-Mapping/noO2rep3_SRR352271_bowtie_sorted.bam -bed /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_ORFs.gff > noO2rep3_SRR352271_gene_counts.gff # Output formating sed 's/^.*ID=//' noO2rep3_SRR352271_gene_counts.gff > noO2rep3_SRR352271_gene_counts.tab Take a look at the final counting matrices to see how the files are organised. At the end of RNA-seq data analysis your directory should look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u251c\u2500\u2500 2-Mapping \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam.bai \u2502 \u251c\u2500\u2500 core \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam.bai \u2514\u2500\u2500 3-Counts \u251c\u2500\u2500 O2rep2_SRR352263_gene_counts.gff \u251c\u2500\u2500 O2rep2_SRR352263_gene_counts.tab \u251c\u2500\u2500 noO2rep3_SRR352271_gene_counts.gff \u2514\u2500\u2500 noO2rep3_SRR352271_gene_counts.tab Unload the tools you used module unload fastqc/0.12.1 bowtie/1.3.1 samtools/1.21 bedtools/2.31.1 Count matrix normalisation Connect to Rstudio server of the IFB. Look at the tutorial on how to connect to IFB-core Rstudio server to see how to proceed. Save the working notebook in your personal environment In \" File > Open File... \" enter the path /shared/projects/2528_ens_master2lf_fgat/data/tutorials/preprocessing_rnaseq.Rmd to open the notebook containing all the code needed for the practical. 2. Save it into your personal folder on your IFB account using \" File > Save As \" Follow the instruction of the notebook to conduct the analysis You can also visualize the final report version . You can find help on how to use R markdown on the R markdown project webpage .","title":"2. Preprocessing"},{"location":"Preprocessing/Preprocessing/#preprocessing-of-high-throughput-data","text":"Introduction Microarrays data preprocessing RNAseq data preprocessing","title":"Preprocessing of high throughput data"},{"location":"Preprocessing/Preprocessing/#introduction","text":"Objective of this practical session During this practical session, you will learn: To perform experimental biases estimation and correction of microarrays GPR files. You will first perform quality control of the imaged glass slides before choosing the best normalisation method to apply. To conduct an analysis of RNA-seq raw fastq files. You will first perform quality control of the sequencer file outputs before proceding to the mapping of the reads onto the reference genome and normalise your data.","title":"Introduction"},{"location":"Preprocessing/Preprocessing/#microarrays-data-preprocessing","text":"","title":"Microarrays data preprocessing"},{"location":"Preprocessing/Preprocessing/#set-up-your-working-environment","text":"Connect to Rstudio server of the IFB. Look at the tutorial on how to connect to IFB-core Rstudio server to see how to proceed.","title":"Set up your working environment"},{"location":"Preprocessing/Preprocessing/#save-the-working-notebook-in-your-personal-environment","text":"In \" File > Open File... \" enter the path /shared/projects/2528_ens_master2lf_fgat/data/tutorials/preprocessing_microarrays.Rmd to open the notebook containing all the code needed for the practical. 2. Save it into your personal folder on your IFB account using \" File > Save As \". You can access the path of your home folder using \"~\".","title":"Save the working notebook in your personal environment"},{"location":"Preprocessing/Preprocessing/#follow-the-instruction-of-the-notebook-to-conduct-the-analysis","text":"You can also visualize the final report version . You can find help on how to use R markdown on the R markdown project webpage .","title":"Follow the instruction of the notebook to conduct the analysis"},{"location":"Preprocessing/Preprocessing/#rnaseq-data-preprocessing","text":"","title":"RNAseq data preprocessing"},{"location":"Preprocessing/Preprocessing/#set-up-your-working-environment_1","text":"Connect to the IFB-core JupyterLab server. Look at the tutorial to see how to proceed. You can also look at the useful commands to work on the IFB-core Cluster page. Go to your home directory cd Create a directory that will contain all results of the upcoming analyses mkdir RNAseq Go to the newly created directory cd RNAseq Check your are in the right directory using the pwd command pwd /shared/home/<your login>/RNAseq","title":"Set up your working environment"},{"location":"Preprocessing/Preprocessing/#sequence-quality-controls","text":"Fastq files Fastq files are raw results from RNA-seq experiments. These files comprise all the sequences (or reads) obtained from the sequencer device (Illumina technology in this practical), together with base quality scores (PHRED scores). Two different files will be analyzed during this practical from Guida et al. publication: O2rep2_SRR352263.fastq refereed to a transcriptome analysis of yeasts C. parapsilosis under normoxic condition ( ENA access number: SRR352263 ) noO2rep3_SRR352271.fastq refereed to a transcriptome analysis of yeasts C. parapsilosis under hypoxic condition ( ENA access number: SRR352271 ) In a first step, controls will be performed on each FASTQ files in order to evaluate the overall quality of the sequences and identify potential problems that could impact the following analyses. During this practical we will use the FastQC software solution. FastQC FastQC is a quality control application for high throughput sequence data. It provides an interactive application to review the results of several different quality control checks, and create an HTML based report . The main functions of FastQC are: Import of data from BAM, SAM or FastQ files (any variant) Providing a quick overview to tell you in which areas there may be problems Summary graphs and tables to quickly assess your data Export of results to an HTML based report Offline operation mode to allow automated generation of reports without running the interactive application What you have to do Use FASTQC to evaluate the quality of sequences in each FASTQ files. Using information from the Fastqc help page as well as exemples of good or bad illumina data as references. Compare results between the two FASTQ files. Is there any concern related to the following analyses?","title":"Sequence quality controls"},{"location":"Preprocessing/Preprocessing/#create-a-new-directory-to-store-the-output-of-fastqc","text":"mkdir 1-QC # Using the `tree` command, your directory should look like this: tree \u2502 \u2514\u2500\u2500\u25001-QC","title":"Create a new directory to store the output of fastqc"},{"location":"Preprocessing/Preprocessing/#go-to-this-directory","text":"cd 1-QC","title":"Go to this directory"},{"location":"Preprocessing/Preprocessing/#make-fastqc-available-in-your-environment","text":"module load fastqc/0.12.1","title":"Make fastqc available in your environment"},{"location":"Preprocessing/Preprocessing/#run-fastqc-on-each-experiment-files","text":"# Absolute path to the file: # /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/O2rep2_SRR352263.fastq # # -o option creates all output files in the specified output directory, # '.' means current directory # O2 condition fastqc /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/O2rep2_SRR352263.fastq -o . # noO2 condition fastqc /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/noO2rep3_SRR352271.fastq -o . At this point you should see the new files in your directory using the tree command tree \u2502 \u2514\u2500\u2500\u25001-QC \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.html \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.zip \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.html \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.zip","title":"Run fastqc on each experiment files"},{"location":"Preprocessing/Preprocessing/#open-the-html-file-reports-on-your-local-machine","text":"Select \"Home directory\", from the \"Files\" menu of your IFB cluster Open On Demand dashboard. Navigate through the \"1-QC\" directory and open the .html reports using your internet browser.","title":"Open the HTML file reports on your local machine"},{"location":"Preprocessing/Preprocessing/#mapping-of-reads-on-the-reference-genome","text":"Once data quality is verified, reads will be mapped onto the reference genome of yeast C. parapsilosis . The genome sequence of C. parapsilosis and its annotations (locations of ORFs) were retrieved from the Candidat genome database (CGD) . Bowtie Different aligner and algorithms for RNA-seq analysis exist. We will use Bowtie 1.3 an ultrafast (memory-efficient) short read aligner. As an input, Bowtie uses a Fastq file (with reads to be aligned) and \u201cpre-built indexes\u201d of the reference genome. These indexes are named \u201cC_parapsilosis.1.ebwt\u201d , \u201cC_parapsilosis.2.ebwt\u201d , etc. They will allow boosting the alignment process. As an output, Bowtie provides a SAM file . SAM (Sequence Alignment/Map) is a generic format for storing large nucleotide sequence alignments. What you have to do Run sequence alignments with Bowtie using the two Fastq files While Bowtie is running, take a look at Bowtie documentation that describes the options (particularly the -m ) Look at the alignment statistic outputs (file .out) What is the proportion of reads aligned on the reference genome? Is there any concern to take into account for the following analyses?","title":"Mapping of reads on the reference genome"},{"location":"Preprocessing/Preprocessing/#create-a-new-directory-to-store-the-output-of-bowtie","text":"#Go back to the parental directory \"RNAseq\" cd ../ #Create a new directory to store results of the alignment mkdir 2-Mapping Your directory should now look like this : tree \u2502 \u2514\u2500\u2500\u25001-QC \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.html \u2514\u2500\u2500\u2500 O2rep2_SRR352263.fastqc.zip \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.html \u2514\u2500\u2500\u2500 noO2rep3_SRR352271.fastqc.zip \u2514\u2500\u2500\u2500 2-Mapping","title":"Create a new directory to store the output of bowtie"},{"location":"Preprocessing/Preprocessing/#go-to-the-newly-created-directory","text":"cd 2-Mapping","title":"Go to the newly created directory"},{"location":"Preprocessing/Preprocessing/#load-bowtie-into-your-environment","text":"module load bowtie/1.3.1","title":"Load Bowtie into your environment"},{"location":"Preprocessing/Preprocessing/#map-the-reads-to-the-reference-genome","text":"## We will use the following options: # \"-S\" will output the result in SAM format # # \"/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/bowtie_indexes/C_parapsilosis\" # specify the location and the \"prefix (C_parapsilosis)\"\" of the bowtie's # index files # # \"/shared/projects/2528_ens_master2lf_fgat/data/rnaseq/Fastqc/O2rep2_SRR352263.fastq.gz\" # location of the input fastq # # \"2>\" will save in a file some statistics about the aligment (number of # reads mapped, etc...) # # \"> redirects the mapping output into a .sam file # Map the aerobic condition reads bowtie -S /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/bowtie_indexes/C_parapsilosis /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/O2rep2_SRR352263.fastq 2> O2rep2_SRR352263_bowtie_mapping.out > O2rep2_SRR352263_bowtie_mapping.sam # Map the hypoxic condition reads bowtie -S /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/bowtie_indexes/C_parapsilosis /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/noO2rep3_SRR352271.fastq 2> noO2rep3_SRR352271_bowtie_mapping.out > noO2rep3_SRR352271_bowtie_mapping.sam Your directory should now look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u2514\u2500\u2500 2-Mapping \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam Take a look at the outputs of the mapping step less O2rep2_SRR352263_bowtie_mapping.out # reads processed: 10213665 # reads with at least one reported alignment: 9160950 (89.69%) # reads that failed to align: 1052715 (10.31%) # reported 9160950 alignments less noO2rep3_SRR352271_bowtie_mapping.out # reads processed: 10136009 # reads with at least one reported alignment: 9252408 (91.28%) # reads that failed to align: 883601 (8.72%) # reported 9252408 alignment","title":"Map the reads to the reference genome"},{"location":"Preprocessing/Preprocessing/#post-processing-of-alignment-files","text":"In order to facilitate alignement manipulation, SAM files have to be converted into BAM files (a binary version) and alignements \u201csorted\u201d according to their localisation on the genome and files indexed in order to speed up their access. We will use the Samtools suite to perform these steps. What you have to do Convert SAM files into BAM files Sort and index BAM files","title":"Post-processing of alignment files"},{"location":"Preprocessing/Preprocessing/#sort-and-convert-sam-into-bam-files","text":"## \"samtools sort\" sort alignments by genomic coordinates # \"|\" \"pipe\" the output of samtools sort to the next program # ## \"samtools view\" will convert sam into bam # option \"-b\" specify the output to be in BAM format # \">\"\" write the output in the bam file module load samtools/1.21 # Sort and convert O2 condition samtools sort O2rep2_SRR352263_bowtie_mapping.sam | samtools view -b > O2rep2_SRR352263_bowtie_sorted.bam # Sort and convert noO2 condition samtools sort noO2rep3_SRR352271_bowtie_mapping.sam | samtools view -b > noO2rep3_SRR352271_bowtie_sorted.bam Error message using samtools If you get an error message during samtools execution, check that you booked 2G of RAM for your JupyterLab environment.","title":"Sort and convert .sam into .bam files"},{"location":"Preprocessing/Preprocessing/#create-indexes-for-the-bam-files","text":"The index of a bam file is named .bam.bai # Index the O2 condition samtools index O2rep2_SRR352263_bowtie_sorted.bam # Index the noO2 condition samtools index noO2rep3_SRR352271_bowtie_sorted.bam Your directory should now look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u2514\u2500\u2500 2-Mapping \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam.bai \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam.bai","title":"Create indexes for the bam files"},{"location":"Preprocessing/Preprocessing/#gene-counts-estimation","text":"To identify genes whose expression is different between hypoxic and normoxic conditions, we will count and compare the number of reads mapped to each ORF . A program available in the Bedtools suite will be used for this purpose. What you have to do Calculate for each ORF the number of reads that were aligned (normoxic and hypoxic conditions).","title":"Gene counts estimation"},{"location":"Preprocessing/Preprocessing/#create-a-new-directory-to-store-the-orf-count-matrix","text":"# Go to the parental directory \"RNAseq\" cd ../ # Create a new directory to store results of the alignment mkdir 3-Counts Your directory should now look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u251c\u2500\u2500 2-Mapping \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam.bai \u2502 \u251c\u2500\u2500 core \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam.bai \u2514\u2500\u2500 3-Counts","title":"Create a new directory to store the ORF count matrix"},{"location":"Preprocessing/Preprocessing/#go-to-the-newly-created-directory_1","text":"cd 3-Counts","title":"Go to the newly created directory"},{"location":"Preprocessing/Preprocessing/#calculate-for-each-orf-the-number-of-reads-that-were-aligned-to-it","text":"module load bedtools/2.31.1 # Counting matrix for the O2 condition bedtools multicov -bams ../2-Mapping/O2rep2_SRR352263_bowtie_sorted.bam -bed /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_ORFs.gff > O2rep2_SRR352263_gene_counts.gff # Output formating sed 's/^.*ID=//' O2rep2_SRR352263_gene_counts.gff > O2rep2_SRR352263_gene_counts.tab # Counting matrix for the noO2 condition bedtools multicov -bams ../2-Mapping/noO2rep3_SRR352271_bowtie_sorted.bam -bed /shared/projects/2528_ens_master2lf_fgat/data/rnaseq/C_parapsilosis_ORFs.gff > noO2rep3_SRR352271_gene_counts.gff # Output formating sed 's/^.*ID=//' noO2rep3_SRR352271_gene_counts.gff > noO2rep3_SRR352271_gene_counts.tab Take a look at the final counting matrices to see how the files are organised. At the end of RNA-seq data analysis your directory should look like this : tree . \u251c\u2500\u2500 1-QC \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.html \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_fastqc.zip \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_fastqc.html \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_fastqc.zip \u251c\u2500\u2500 2-Mapping \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.out \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam \u2502 \u251c\u2500\u2500 O2rep2_SRR352263_bowtie_sorted.bam.bai \u2502 \u251c\u2500\u2500 core \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.out \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_mapping.sam \u2502 \u251c\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam \u2502 \u2514\u2500\u2500 noO2rep3_SRR352271_bowtie_sorted.bam.bai \u2514\u2500\u2500 3-Counts \u251c\u2500\u2500 O2rep2_SRR352263_gene_counts.gff \u251c\u2500\u2500 O2rep2_SRR352263_gene_counts.tab \u251c\u2500\u2500 noO2rep3_SRR352271_gene_counts.gff \u2514\u2500\u2500 noO2rep3_SRR352271_gene_counts.tab","title":"Calculate for each ORF the number of reads that were aligned to it"},{"location":"Preprocessing/Preprocessing/#unload-the-tools-you-used","text":"module unload fastqc/0.12.1 bowtie/1.3.1 samtools/1.21 bedtools/2.31.1","title":"Unload the tools you used"},{"location":"Preprocessing/Preprocessing/#count-matrix-normalisation","text":"Connect to Rstudio server of the IFB. Look at the tutorial on how to connect to IFB-core Rstudio server to see how to proceed.","title":"Count matrix normalisation"},{"location":"Preprocessing/Preprocessing/#save-the-working-notebook-in-your-personal-environment_1","text":"In \" File > Open File... \" enter the path /shared/projects/2528_ens_master2lf_fgat/data/tutorials/preprocessing_rnaseq.Rmd to open the notebook containing all the code needed for the practical. 2. Save it into your personal folder on your IFB account using \" File > Save As \"","title":"Save the working notebook in your personal environment"},{"location":"Preprocessing/Preprocessing/#follow-the-instruction-of-the-notebook-to-conduct-the-analysis_1","text":"You can also visualize the final report version . You can find help on how to use R markdown on the R markdown project webpage .","title":"Follow the instruction of the notebook to conduct the analysis"}]}